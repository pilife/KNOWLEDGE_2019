# LSH

局部敏感哈希算法(Locality Sensitive Hashing)

## 作用
LSH最根本的作用，就是能高效处理海量高维数据的最近邻问题



## 定义

我们将这样的一族hash函数 H={h:S→U} 称为是(r1,r2,p1,p2)敏感的，如果对于任意H中的函数h，满足以下2个条件：
$$
if\ d(O1,O2)<r1，then\ Pr[h(O1)=h(O2)]≥p1
$$

$$
if\ d(O1,O2)>r2，then\ Pr[h(O1)=h(O2)]≤p2
$$

其中，$O1,O2∈S$，表示两个具有多维属性的数据对象，$d(O1,O2)$为2个对象的相异程度，也就是1 - 相似度。其实上面的这两个条件说得直白一点，就是当足够相似时，映射为同一hash值的概率足够大；而足够不相似时，映射为同一hash值的概率足够小。

<u>这里的d函数，即判断两个对象的距离的标准不同，则对应的hash函数的策略就得不同。即使得$P(h(Si)=h(Sj)) = sim(Si,Sj)$，这里sim函数和d函数相反，即在一个距离判断标准下，两个对象越接近，则他们hash值相等的概率越大。</u>***注意这里变成了等号来表示两者之间的关系***。
比如:
	- 如果用Jaccard系数度量数据相似度时,则采用min-hashing
	- 如果用欧氏距离度量数据相似度时的P-stable hash



## 不同度量方法下的Hash函数

#### Jaccard系数—>Min-hashing

**定义**：特征矩阵按行进行一个随机的排列后，第一个列值为1的行的行号。

**证明**：我们考虑$Si$和$Sj$这两列，它们所在的行的所有可能结果可以分成如下三类：

　　（1）A类：两列的值都为1；

　　（2）B类：其中一列的值为0，另一列的值为1；

　　（3）C类：两列的值都为0.

​	特征矩阵相当稀疏，导致大部分的行都属于C类，但只有A、B类行的决定$sim(Si,Sj)$，假定A类行有a个，B类行有b个，那么根据Jaccard系数度量的概念（交/并），$sim(si,sj)=a/(a+b)$。

​	现在我们只需要证明对矩阵行进行随机排列，两个的最小hash值相等的概率$P(h(Si)=h(Sj))=a/(a+b)$，如果我们把C类行都删掉，那么第一行不是A类行就是B类行，如果第一行是A类行那么$h(Si)=h(Sj)$，因此$P(h(Si)=h(Sj))=P(删掉C类行后，第一行为A类)=A类行的数目/所有行的数目=a/(a+b)$，这就是最小hash正确性的原理。



